const {Command} = require('commander');
const path      = require('node:path');

const program = new Command();

program.option('-s, --search-depth <number>', 'set search depth', '-1')
    .option(
        '-d, --deduce-assets-path', 'deduce assets path from base directory')
    .option('-u, --use-path-relative-index', 'use path relative index')
    .option('-a, --archive', 'archive')
    .option('-e, --entry-point <string>', 'set entry point', 'index.html')
    .option(
        '-w, --weak-replacement', 'set replacement policy for ', 'your file')
    .arguments('<path|archive|url>')
    .action(p => {
        console.log(p);
    })
    .parse(process.argv);

const options = program.opts();

if (options.help) {
    program.outputHelp();
    process.exit(0);
} else {
    console.log(options);
}


function isAbsoluteURI(link) {
    return isURI(link);
}

function isURI(link) {
    try {
        const idx = link.indexOf('://');
        if (idx === -1) {
            if (isWindowsPath(link))
                return false;

            new URL(link);
            return true;
        } else {
            const scheme = link.slice(0, idx);
            return supportedSchemes.includes(scheme);
        }
    } catch (error) {
        return false;
    }
}
