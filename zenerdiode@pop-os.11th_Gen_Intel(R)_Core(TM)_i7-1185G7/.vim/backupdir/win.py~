import gi
gi.require_version('Gtk', '3.0')
gi.require_version('Wnck', '3.0')
from gi.repository import Gtk, Wnck

# Gtk.init([])  # necessary only if not using a Gtk.main() loop
screen = Wnck.Screen.get_default()
# screen.force_update()  # recommended per Wnck documentation

# loop all windows
for window in screen.get_windows():
    print(window.get_name(), window.get_geometry())
    # ... do whatever you want with this window

# clean up Wnck (saves resources, check documentation)
# window = None
screen = None
# Wnck.shutdown()
